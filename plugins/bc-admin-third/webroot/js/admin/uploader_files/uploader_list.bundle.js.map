{"version":3,"file":"admin/uploader_files/uploader_list.bundle.js","mappings":"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","sources":["webpack://bc-admin-third/./src/js/admin/uploader_files/uploader_list.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * 起動時処理\n */\n$(function () {\n\n    var listId = $(\"#ListId\").html();\n\n    //==========================================================================\n    // 複数のエディタよりリストが呼出される可能性がある為、#ListIdの値を読み込んだら削除する\n    // TODO 強引すぎるので他の方法がないか検討要\n    //==========================================================================\n    $(\"#ListId\").remove();\n\n    var allFields = $([]).add($(\"#name\")).add($(\"#alt\"));\n    var baseUrl = $.baseUrl() + '/';\n    var adminPrefix = $(\"#AdminPrefix\").html();\n    var categoryId = null;\n\n    // 一覧を更新する\n    updateFileList();\n\n    /* ダイアログを初期化 */\n    $(\"#EditDialog\").dialog({\n        bgiframe: true,\n        autoOpen: false,\n        position: {at: \"center center\", of: window},\n        width: 960,\n        modal: true,\n        open: function () {\n            var name = $(\"#FileList\" + listId + \" .selected .name\").html();\n            var imgUrl = baseUrl + adminPrefix + '/uploader/uploader_files/ajax_image/' + name + '/midium';\n            $(\"#UploaderFileId\" + listId).val($(\"#FileList\" + listId + \" .selected .id\").html());\n            $(\"#UploaderFileName\" + listId).val(name);\n            $(\"#UploaderFileAlt\" + listId).val($(\"#FileList\" + listId + \" .selected .alt\").html());\n\n            /* ダイアログ初期化時、hidden値が空になるため公開期間開始日時を取得して hidden値に入れ込む */\n            var publishBeginDate = $(\"#FileList\" + listId + \" .selected .publish-begin\").html();\n            var publishBeginTime = $(\"#FileList\" + listId + \" .selected .publish-begin-time\").html();\n            $(\"#UploaderFilePublishBeginDate\").val(publishBeginDate);\n            $(\"#UploaderFilePublishBeginTime\").val(publishBeginTime);\n            var publishBeginDateTime = publishBeginDate;\n            if (publishBeginTime) {\n                publishBeginDateTime += ' ' + publishBeginTime;\n            }\n            $(\"#UploaderFilePublishBegin\").val(publishBeginDateTime);\n\n            /* ダイアログ初期化時、hidden値が空になるため公開期間終了日時を取得して hidden値に入れ込む */\n            var publishEndDate = $(\"#FileList\" + listId + \" .selected .publish-end\").html();\n            var publishEndTime = $(\"#FileList\" + listId + \" .selected .publish-end-time\").html();\n            $(\"#UploaderFilePublishEndDate\").val(publishEndDate);\n            $(\"#UploaderFilePublishEndTime\").val(publishEndTime);\n            var publishEndDateTime = publishEndDate;\n            if (publishEndTime) {\n                publishEndDateTime += ' ' + publishEndTime;\n            }\n            $(\"#UploaderFilePublishEnd\").val(publishEndDateTime);\n\n            $(\"#UploaderFileUserId\" + listId).val($(\"#FileList\" + listId + \" .selected .user-id\").html());\n            $(\"#UploaderFileUserName\" + listId).html($(\"#FileList\" + listId + \" .selected .user-name\").html());\n            if ($(\"#_UploaderFileUploaderCategoryId\" + listId).length) {\n                $(\"#_UploaderFileUploaderCategoryId\" + listId).val($(\"#FileList\" + listId + \" .selected .uploader-category-id\").html());\n            }\n            $.get(imgUrl, function (res) {\n                $(\"#UploaderFileImage\" + listId).html(res);\n            });\n        },\n        buttons: {\n            cancel: {\n                text: bcI18n.uploaderCancel,\n                click: function () {\n                    $(this).dialog('close');\n                    $(\"#UploaderFileImage\" + listId).html('<img src=\"' + baseUrl + 'img/admin/ajax-loader.gif\" />');\n                }\n            },\n            save: {\n                text: bcI18n.uploaderSave,\n                click: function () {\n                    // 保存処理\n                    var saveButton = $(this);\n                    $.bcToken.check(function () {\n                        // IEでform.serializeを利用した場合、Formタグの中にTableタグがあるとデータが取得できなかった\n                        var data = {\n                            \"data[UploaderFile][id]\": $(\"#UploaderFileId\" + listId).val(),\n                            \"data[UploaderFile][name]\": $(\"#UploaderFileName\" + listId).val(),\n                            \"data[UploaderFile][alt]\": $(\"#UploaderFileAlt\" + listId).val(),\n                            \"data[UploaderFile][publish_begin]\": $(\"#UploaderFilePublishBegin\" + listId).val(),\n                            \"data[UploaderFile][publish_end]\": $(\"#UploaderFilePublishEnd\" + listId).val(),\n                            \"data[UploaderFile][user_id]\": $(\"#UploaderFileUserId\" + listId).val(),\n                            \"data[UploaderFile][uploader_category_id]\": $(\"#_UploaderFileUploaderCategoryId\" + listId).val(),\n                            \"_csrfToken\": $.bcToken.key\n                        };\n                        return $.bcUtil.ajax($(\"#UploaderFileEditForm\" + listId).attr('action'), function (res) {\n                            if (res) {\n                                updateFileList();\n                                allFields.removeClass('ui-state-error');\n                                saveButton.dialog('close');\n                                $(\"#UploaderFileImage\" + listId).html('<img src=\"' + baseUrl + 'img/admin/ajax-loader.gif\" />');\n                            } else {\n                                $.bcUtil.hideLoader();\n                                alert(bcI18n.uploaderAlertMessage1);\n                            }\n                            $.bcToken.key = null;\n                        }, {data: data});\n                    }, {hideLoader: false, useUpdate: false});\n                }\n            }\n        },\n        close: function () {\n            allFields.val('').removeClass('ui-state-error');\n            $(\"#UploaderFileImage\" + listId).html('<img src=\"' + baseUrl + 'img/admin/ajax-loader.gif\" />');\n        }\n\n    });\n\n    /**\n     * アップロードファイル選択時イベント\n     */\n    function uploaderFileFileChangeHandler() {\n        var url = $.bcUtil.apiBaseUrl + 'bc-uploader/uploader_files/upload.json';\n        var $file = $(this);\n        $.bcUtil.showLoader();\n        if ($('#UploaderFileFile' + listId).val()) {\n            $.bcToken.check(function () {\n                let fd = new FormData();\n                fd.append('file', $file.prop('files')[0]);\n                fd.append('_csrfToken', $.bcToken.key);\n                if ($(\"#UploaderFileUploaderCategoryId\" + listId).length) {\n                    fd.append('uploader_category_id', $(\"#UploaderFileUploaderCategoryId\" + listId).val());\n                }\n                return $.ajax({\n                    url: url,\n                    headers: {\n                        \"Authorization\": $.bcJwt.accessToken,\n                    },\n                    type: 'post',\n                    data: fd,\n                    dataType: 'json',\n                    processData: false,\n                    contentType: false,\n                    cache: false,\n                    success: uploadSuccessHandler,\n                    // error: function (XMLHttpRequest) {\n                    //     XMLHttpRequest.responseText = null;\n                    //     $.bcUtil.showAjaxError(bcI18n.commonChangePublishFailedMessage, XMLHttpRequest);\n                    // },\n                    // complete: function () {\n                    //     $.bcUtil.hideLoader();\n                    // }\n                });\n            }, {useUpdate: false, hideLoader: false});\n        }\n    }\n\n    /**\n     * アップロード完了後イベント\n     */\n    function uploadSuccessHandler(res) {\n\n        if (res) {\n            if ($('#UploaderFileUploaderCategoryId' + listId).length) {\n                $('#FilterUploaderCategoryId' + listId).val($('#UploaderFileUploaderCategoryId' + listId).val());\n                categoryId = $('#UploaderFileUploaderCategoryId' + listId).val();\n            }\n            updateFileList();\n        } else {\n            $('#ErrorMessage').remove();\n            $('#FileList' + listId).prepend('<p id=\"ErrorMessage\" class=\"message\">' + bcI18n.uploaderAlertMessage2 + '</p>');\n            $(\"#Waiting\").hide();\n        }\n        // フォームを初期化\n        // セキュリティ上の関係でvalue値を直接消去する事はできないので、一旦エレメントごと削除し、\n        // spanタグ内に新しく作りなおす。\n        $(\"#UploaderFileFile\" + listId).remove();\n        $(\"#SpanUploadFile\" + listId).append('<input id=\"UploaderFileFile' + listId + '\" type=\"file\" value=\"\" name=\"data[UploaderFile][file]\" class=\"uploader-file-file\" />');\n        $('#UploaderFileFile' + listId).change(uploaderFileFileChangeHandler);\n        $.bcToken.key = null;\n\n    }\n\n    /**\n     * 一覧を更新する\n     */\n    function updateFileList() {\n        $.bcUtil.ajax(getListUrl(), updateFileListCompleteHander, {hideLoader: false, type: 'GET'});\n    }\n\n    /**\n     * 指定したファイルの編集ができない状態か確認\n     *\n     * @param fileUserId\n     * @returns {boolean}\n     */\n    function isFileEditDisabled(fileUserId) {\n        var loginUserId = $(\"#LoginUserId\").html();\n        var loginUserGroupId = $(\"#LoginUserGroupId\").html();\n        var usePermission = Number($(\"#UsePermission\").html());\n        var disabled = false;\n        if (loginUserGroupId != 1 && usePermission) {\n            if (loginUserId != fileUserId) {\n                disabled = true;\n            }\n        }\n        return disabled;\n    }\n\n    /**\n     * 選択イベントを初期化する\n     */\n    function initFileList() {\n\n        var usePermission = $(\"#UsePermission\").html();\n\n        if (categoryId) {\n            $('#UploaderFileUploaderCategoryId' + listId).val(categoryId);\n        }\n        /* 一旦イベントを全て解除 */\n        $(\".selectable-file\").unbind('click.selectEvent');\n        $(\".selectable-file\").unbind('mouseenter.selectEvent');\n        $(\".selectable-file\").unbind('mouseleave.selectEvent');\n        $(\".page-numbers a\").unbind('click.paginationEvent');\n        $(\".selectable-file\").unbind('dblclick.dblclickEvent');\n        $(\".filter-control\").unbind('click.filterEvent');\n        $(\".btn-delete\").unbind('click');\n\n        /* 公開制限期間にあるファイルの背景色を定義 */\n        var unpublishBackGroundColor = '#bbb';\n\n        if ($.fn.contextMenu && !listId && $(\"#DivPanelList\").length) {\n            /* 右クリックメニューを追加 */\n            $(\"#DivPanelList\").contextMenu({\n                selector: '.selectable-file',\n                callback: contextMenuHander,\n                build: function ($trigger, e) {\n                    var disabled = isFileEditDisabled($($trigger).find('.user-id').html());\n                    return {\n                        items: {\n                            edit: {\n                                name: bcI18n.uploaderEdit,\n                                icon: 'edit',\n                                disabled: function (key, opt) {\n                                    return disabled;\n                                }\n                            },\n                            delete: {\n                                name: bcI18n.uploaderDelete,\n                                icon: 'delete',\n                                disabled: function (key, opt) {\n                                    return disabled;\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n        }\n\n        $(\"#DivPanelList .selectable-file\").each(function () {\n\n            if ($.fn.contextMenu && !listId) {\n                if (!isFileEditDisabled($(this).find('.user-id').html())) {\n                    $(this).bind('dblclick.dblclickEvent', function () {\n                        $('#EditDialog').dialog('open');\n                    });\n                } else {\n                    $(this).bind('dblclick.dblclickEvent', function () {\n                        alert(bcI18n.uploaderAlertMessage3);\n                    });\n                }\n            } else {\n                $(this).bind(\"contextmenu\", function (e) {\n                    return false;\n                });\n            }\n\n            /* 公開制限期間にあるファイルは背景色をグレーにする */\n            if ($(this).hasClass('unpublish')) {\n                $(this).css('background-color', unpublishBackGroundColor);\n            }\n        });\n\n        // ファイルアップロードイベントを登録\n        $('#UploaderFileFile' + listId).change(uploaderFileFileChangeHandler);\n\n        if (listId) {\n            $(\".selectable-file\").bind('mouseenter.selectEvent', function () {\n                $(this).css('background-color', '#FFCC00');\n            });\n            $(\".selectable-file\").bind('mouseleave.selectEvent', function () {\n                $(this).css('background-color', '#FFFFFF');\n                if ($(this).hasClass('unpublish')) {\n                    $(this).css('background-color', unpublishBackGroundColor);\n                }\n            });\n            $(\".selectable-file\").each(function () {\n                // IEの場合contextmenuを検出できなかったので、mousedownに変更した\n                $(this).bind('mousedown', function () {\n                    $(\".selectable-file\").removeClass('selected');\n                    $(this).addClass('selected');\n                });\n            });\n        } else {\n            $(\"#DivPanelList .selectable-file\").bind('mouseenter.selectEvent', function () {\n                $(this).css('background-color', '#FFCC00');\n            });\n            $(\"#DivPanelList .selectable-file\").bind('mouseleave.selectEvent', function () {\n                $(this).css('background-color', '#FFFFFF');\n                if ($(this).hasClass('unpublish')) {\n                    $(this).css('background-color', unpublishBackGroundColor);\n                }\n            });\n            $(\"#DivPanelList .selectable-file\").each(function () {\n                // IEの場合contextmenuを検出できなかったので、mousedownに変更した\n                $(this).bind('mousedown', function () {\n                    $(\".selectable-file\").removeClass('selected');\n                    $(this).addClass('selected');\n                });\n            });\n        }\n\n        /* ページネーションイベントを追加 */\n        $('.page-numbers a').bind('click.paginationEvent', function () {\n            $(\"#Waiting\").show();\n            $.get($(this).attr('href'), updateFileListCompleteHander);\n            return false;\n        });\n\n        $(\"#BtnFilter\" + listId).bind('click.filterEvent', function () {\n            updateFileList();\n        });\n        /*$('#FilterUploaderCategoryId'+listId).bind('change.filterEvent', function() {\n            $(\"#Waiting\").show();\n            $.get(getListUrl(),updateFileListCompleteHander);\n        });\n        $('input[name=\"data[Filter][uploader_type]\"]').bind('click.filterEvent', function() {\n            $(\"#Waiting\").show();\n            $.get(getListUrl(),updateFileListCompleteHander);\n        });*/\n\n        $(\"#FileList\" + listId).trigger(\"filelistload\");\n        $(\"#FileList\" + listId).effect(\"highlight\", {}, 1500);\n\n    }\n\n    /**\n     * ファイルリスト取得完了イベント\n     */\n    function updateFileListCompleteHander(result) {\n\n        $(\"#FileList\" + listId).html(result);\n        initFileList();\n        $(\"#FileList\" + listId).trigger('loadTableComplete');\n        $(\"#Waiting\").hide();\n\n    }\n\n    /**\n     * Ajax List 取得用のURLを取得する\n     */\n    function getListUrl() {\n        let listUrl = $(\"#ListUrl\" + listId).attr('href');\n        let query = [];\n        if ($('#FilterUploaderCategoryId' + listId).length) {\n            query.push('uploader_category_id=' + $('#FilterUploaderCategoryId' + listId).val());\n        }\n        if ($('input[name=\"data[Filter][uploader_type]\"]:checked').length) {\n            query.push('uploader_type=' + $('input[name=\"data[Filter][uploader_type]\"]:checked').val());\n        }\n        if ($('#FilterName' + listId).val()) {\n            query.push('name=' + encodeURI($('#FilterName' + listId).val()));\n        }\n        if (query.length) {\n            listUrl += '?' + query.join('&');\n        }\n        return listUrl;\n    }\n\n    /**\n     * コンテキストメニューハンドラ\n     */\n    function contextMenuHander(action, el, pos) {\n        var delUrl = baseUrl + adminPrefix + '/uploader/uploader_files/delete/' + $(\"#FileList\" + listId + \" .selected .id\").html();\n\n        // IEの場合、action値が正常に取得できないので整形する\n        var pos = action.indexOf(\"#\");\n\n        if (pos != -1) {\n            action = action.substring(pos + 1, action.length);\n        }\n\n        switch (action) {\n\n            case 'edit':\n                $('#EditDialog').dialog('open');\n                break;\n\n            case 'delete':\n                if (confirm(bcI18n.uploaderConfirmMessage1)) {\n                    $.bcToken.check(function () {\n                        $(\"#Waiting\").show();\n                        return $.bcUtil.ajax(delUrl, function (res) {\n                            if (!res) {\n                                $(\"#Waiting\").hide();\n                                alert(bcI18n.uploaderAlertMessage4);\n                            } else {\n                                $(\"#FileList\" + listId).trigger(\"deletecomplete\");\n                                updateFileList();\n                            }\n                            $.bcToken.key = null;\n                        }, {\n                            data: {\n                                _Token: {key: $.bcToken.key}\n                            }, hideLoader: false\n                        });\n                    }, {useUpdate: false, hideLoader: false});\n                }\n                break;\n        }\n    }\n\n});\n"],"names":["$","listId","html","remove","allFields","add","baseUrl","adminPrefix","categoryId","uploaderFileFileChangeHandler","url","bcUtil","apiBaseUrl","$file","this","showLoader","val","bcToken","check","fd","FormData","append","prop","key","length","ajax","headers","bcJwt","accessToken","type","data","dataType","processData","contentType","cache","success","uploadSuccessHandler","useUpdate","hideLoader","res","updateFileList","prepend","bcI18n","uploaderAlertMessage2","hide","change","listUrl","query","attr","push","encodeURI","join","updateFileListCompleteHander","isFileEditDisabled","fileUserId","loginUserId","loginUserGroupId","usePermission","Number","disabled","result","unbind","unpublishBackGroundColor","fn","contextMenu","selector","callback","contextMenuHander","build","$trigger","e","find","items","edit","name","uploaderEdit","icon","opt","delete","uploaderDelete","each","bind","alert","uploaderAlertMessage3","dialog","hasClass","css","removeClass","addClass","show","get","trigger","effect","initFileList","action","el","pos","delUrl","indexOf","substring","confirm","uploaderConfirmMessage1","uploaderAlertMessage4","_Token","bgiframe","autoOpen","position","at","of","window","width","modal","open","imgUrl","publishBeginDate","publishBeginTime","publishBeginDateTime","publishEndDate","publishEndTime","publishEndDateTime","buttons","cancel","text","uploaderCancel","click","save","uploaderSave","saveButton","uploaderAlertMessage1","close"],"sourceRoot":""}